## 要件定義書：Ephemeral Diary (エフェメラル・ダイアリー)

### 1. 概要

#### 1.1. プロジェクトの目的

本プロジェクトは、日々の出来事や感情を長文で記録することに負担を感じるユーザーに対し、「色」と「一言」という直感的でミニマルな手段を提供する。記録の積み重ねが美しいビジュアルとして表現されることで、ユーザーに日々の振り返りの楽しさと、感傷的でパーソナルな体験を提供することを目的とする。

#### 1.2. プロダクト概要

「一瞬」を記録するための、儚くて美しい日記アプリケーション。ユーザーは、その日を象徴する「色」と 140 字以内の「一言」を記録する。記録されたデータは、グラデーションが美しいカレンダーや、星空のようにインタラクティブなタイムラインとして可視化され、ユーザー自身の感情の軌跡を眺めて楽しむことができる。

#### 1.3. ターゲットユーザー

- 日記をつけたいが、長文を書くのが苦手・面倒で続かない人
- デザインやエモーショナルな体験を重視する 20 代〜30 代の男女
- 自分の感情の起伏や日々のムードを手軽に可視化してみたい人

---

### 2. 機能要件

ユーザーがアプリケーションで実現できることを定義します。

#### 2.1. ユーザー管理機能

| 機能 ID | 機能名              | 機能概要                                             | 備考                        |
| :------ | :------------------ | :--------------------------------------------------- | :-------------------------- |
| F-001   | 新規アカウント登録  | メールアドレスとパスワードでアカウントを作成できる。 | MVP では SNS 認証は含めない |
| F-002   | ログイン/ログアウト | 登録したアカウントでログイン・ログアウトできる。     | セッション管理が必要        |
| F-003   | 退会                | サービスを退会し、自身の全データを削除できる。       |                             |

#### 2.2. 日記記録機能

| 機能 ID | 機能名          | 機能概要                                                              | 備考                             |
| :------ | :-------------- | :-------------------------------------------------------------------- | :------------------------------- |
| F-101   | 日記の新規作成  | アプリを開くと、その日の日記を作成できる画面が表示される。            | 1 日 1 記録を原則とする          |
| F-102   | 色の選択        | 用意されたカラーパレットから、その日の気分に合った色を 1 色選択する。 | 色は HEX コード(#RRGGBB)等で管理 |
| F-103   | コメントの入力  | 140 字以内で一言コメントを入力できる。                                | 入力は任意とする                 |
| F-104   | 日記の保存      | 選択した色とコメントを、その日の日付と紐づけて保存する。              |                                  |
| F-105   | 日記の編集/削除 | 記録した日の日記を後から編集・削除できる。                            |                                  |

#### 2.3. 記録表示機能

| 機能 ID | 機能名           | 機能概要                                                                                                           | 備考                                                                                             |
| :------ | :--------------- | :----------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------- |
| F-201   | カレンダー表示   | 月間カレンダー形式で、記録した日のマスがその日の「色」で塗りつぶされる。                                           | 色が記録されていない日はデフォルト色（例：薄いグレー）で表示。日付をタップすると日記詳細を表示。 |
| F-202   | タイムライン表示 | 記録を時系列で表示する。記録が美しいビジュアル（星空、流れる川など）で表現される。                                 | スクロールなどの操作に連動したアニメーションを伴う。                                             |
| F-203   | 日記詳細表示     | カレンダーやタイムラインから特定の日付を選択すると、その日の「色」と「コメント」をモーダルウィンドウ等で表示する。 |                                                                                                  |

#### 2.4. 振り返り機能

| 機能 ID | 機能名           | 機能概要                                                                                   | 備考                                   |
| :------ | :--------------- | :----------------------------------------------------------------------------------------- | :------------------------------------- |
| F-301   | 去年の今日の記録 | トップページ等で、1 年前の同じ日に記録があれば、その「色」と「コメント」を自動で表示する。 | 1 年以上利用しているユーザー向けの機能 |

---

### 3. 非機能要件

システムの品質や制約に関する要件を定義します。

| 項目                       | 要件                                                                                                                                                                                                                                                |
| :------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **パフォーマンス**         | ・ページ遷移やアニメーションはユーザーにストレスを与えないよう、高速に（目標 0.5 秒以内）表示を完了させる。<br>・タイムライン表示など、データ量が多くなる画面でも描画がもたつかないこと。                                                           |
| **ユーザビリティ (UI/UX)** | ・コンセプトである「儚さ」「美しさ」を体現する、シンプルで直感的な UI。<br>・アプリ起動から日記記録完了までが、最低限のステップ（3 ステップ以内）で完結する。<br>・心地よいと感じるページ遷移アニメーションや、マイクロインタラクションを実装する。 |
| **対応環境**               | ・**プラットフォーム**: Web アプリケーションとして提供。<br>・**レスポンシブ対応**: PC、スマートフォンの両方のブラウザで最適に表示・操作できること。<br>・**対応ブラウザ**: 最新版の Google Chrome, Safari, Firefox, Microsoft Edge。               |
| **セキュリティ**           | ・パスワードはハッシュ化してデータベースに保存する。<br>・すべての通信は HTTPS で暗号化する。<br>・XSS（クロスサイトスクリプティング）や CSRF（クロスサイトリクエストフォージェリ）等の基本的な脆弱性対策を講じる。                                 |
| **保守性・拡張性**         | ・コードはリーダブルであり、コンポーネント指向で再利用性の高い設計とする。<br>・将来的な機能追加（カラーパレットの追加、テーマ機能など）が容易な構造であること。                                                                                    |

---

### 4. 技術要件・システム構成案

#### 4.1. データ保存形式

- **色**: `String`型でカラーコード（例: `#FF5733`）をそのまま保存する。これにより、CSS や Canvas での描画が容易になる。

#### 4.2. 技術スタック（案）

- **フロントエンド**:
  - **フレームワーク**: React (Next.js) または Vue (Nuxt.js)
  - **データビジュアライゼーション**: SVG, Canvas API。またはライブラリとして `D3.js`, `Three.js`, `p5.js` の利用を検討。
  - **アニメーション**: `Framer Motion` (React) or `GSAP`
- **バックエンド**:
  - **フレームワーク**: Node.js (Express), または BaaS (Backend as a Service) である `Firebase` や `Supabase` の利用を検討。BaaS を利用すると、認証や DB 構築を迅速に行える。
- **データベース**:
  - `PostgreSQL` (リレーショナル) または `Firestore` / `MongoDB` (NoSQL)
- **インフラ**:
  - `Vercel` / `Netlify` (フロントエンド), `Heroku` / `AWS` / `GCP` (バックエンド)

#### 4.3. データモデル（案）

**`users` テーブル**
| カラム名 | データ型 | 説明 |
|:---|:---|:---|
| `id` | UUID | 主キー |
| `email` | VARCHAR(255) | メールアドレス (UNIQUE) |
| `password_hash` | VARCHAR(255) | ハッシュ化されたパスワード |
| `created_at` | TIMESTAMP | 作成日時 |

**`diaries` テーブル**
| カラム名 | データ型 | 説明 |
|:---|:---|:---|
| `id` | UUID | 主キー |
| `user_id` | UUID | 外部キー (`users.id`) |
| `date` | DATE | 日記の日付 (user_id と date で複合ユニーク) |
| `color_code` | VARCHAR(7) | 色の HEX コード (例: `#RRGGBB`) |
| `comment` | TEXT | コメント (140 字以内、NULL 許容) |
| `created_at` | TIMESTAMP | 作成日時 |
| `updated_at` | TIMESTAMP | 更新日時 |

---

### 5. 開発スコープ（案）

#### 5.1. MVP (Minimum Viable Product) で実装する範囲

まずはプロダクトのコアな価値を最速でユーザーに届けるため、以下の機能に絞って開発します。

- **機能**:
  - アカウント登録・ログイン機能 (F-001, F-002)
  - 日記の新規作成・保存機能 (F-101, F-102, F-103, F-104)
  - カレンダー表示機能 (F-201)
  - 日記詳細表示機能 (F-203)
- **非機能要件**:
  - スマートフォンブラウザでの利用を主としたレスポンシブ対応

#### 5.2. MVP 以降の拡張機能

- タイムライン表示機能 (F-202) の実装とビジュアルの作り込み
- 「去年の今日のあなた」機能 (F-301)
- 日記の編集・削除機能 (F-105)
- SNS（Google, Twitter 等）ログイン機能
- カラーパレットのカスタマイズ機能
- PWA (Progressive Web Apps) 化による、ネイティブアプリに近い体験の提供
